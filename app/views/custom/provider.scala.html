@(providerId: String, loginForm: Option[Form[(String, String)]] = None)(implicit request: RequestHeader, lang: Lang, env: securesocial.core.RuntimeEnvironment[_])

@import securesocial.core.providers.UsernamePasswordProvider
@import securesocial.core.AuthenticationMethod._
@import play.api.Logger
@import helper._
@import play.api.Play

@implicitFieldConstructor = @{ FieldConstructor(securesocial.views.html.inputFieldConstructor.f) }

@env.providers.get(providerId).map { provider =>
@if( provider.authMethod == OAuth1 || provider.authMethod == OAuth2 ) {
    @defining( "images/providers/%s.png".format(provider.id) ) { imageUrl =>
        <a href="@env.routes.authenticationUrl(provider.id)"> <img src="@controllers.routes.Assets.at(imageUrl)"/></a>
    }
}

@if( provider.authMethod == UserPassword ) {
    <form action="@env.routes.authenticationUrl("userpass")" method="post">
    <div class="body bg-gray">
        @if(loginForm.get.hasErrors) {
        <div class="alert alert-danger alert-dismissable">
            <i class="fa fa-ban"></i>
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Å~</button>
            User ID or password is invalid!
        </div>
        }
        @if( UsernamePasswordProvider.withUserNameSupport ) {
            @helper.inputText(
                loginForm.get("username"),
                '_label -> Messages("securesocial.signup.username"),
                'class -> "form-control",
                'placeholder -> "User ID"
            )
        } else {
            @helper.inputText(
                loginForm.get("username"),
                '_label -> Messages("securesocial.signup.email1"),
                'class -> "form-control",
                'placeholder -> "User ID"
            )
        }

        @helper.inputPassword(
            loginForm.get("password"),
            '_label -> Messages("securesocial.signup.password1"),
            'class -> "form-control",
            'placeholder -> "Password"
        )
        <div class="form-group">
            <input type="checkbox" name="remember_me"/> Remember me
        </div>
    </div>
    <div class="footer">
        <button type="submit" class="btn bg-olive btn-block">Sign me in</button>
    </div>
    </form>
    }
}.getOrElse {
    @*****************************************
    * Todo: throw a runtime exception? this might need improvement
    *****************************************@
    @Logger.error("[securesocial] unknown provider '%s'. Can't render it.".format(providerId))
    { throw new RuntimeException("Unknown provider '%s') }
}
